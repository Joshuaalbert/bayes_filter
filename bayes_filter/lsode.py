"""The Livermore Solver for ODEs written in Tensorflow
Ref. Lawrence Livermore national Laboratory Report UCRL-ID-113855 (1993)

This solver supplies the implicit Adam-Moulton and BDF methods of solving ODEs
"""
import numpy as np
import tensorflow as tf
from .settings import float_type

l_am = np.zeros([12,13], dtype=np.float64)
l_am[:,0] = [1,1/2,5/12,3/8,251/720,95/288,19087/60480,5257/17280,1070017/3628800,25713/89600,26842253/95800320,4777223/17418240]
l_am[:,1] = 1.
l_am[1:,2] = [1/2,3/4,11/12,25/24,137/120,49/40,363/280,761/560,7129/5040,7381/5040,83711/55440]
l_am[2:,3] = [1/6,1/3,35/72,5/8,203/270,469/540,29531/30240,6515/6048,177133/151200,190553/151200]
l_am[3:,4] = [1/24,5/48,17/96,49/192,967/2880,267/640,4523/9072,84095/145152,341747/518400]
l_am[4:,5] = [1/120,1/40,7/144,7/90,1069/9600,19/128,341693/1814400,139381/604800]
l_am[5:,6] = [1/720,1/1440,23/2160,3/160,3013/103680,8591/207360,242537/4354560]
l_am[6:,7] = [1/5040,1/1260,13/6720,5/1344,7513/1209600, 1903/201600]
l_am[7:,8] = [1/40320,1/8960,29/96768,121/193536,10831/9676800]
l_am[8:,9] = [1/362880, 1/72576,11/272160,11/120960]
l_am[9:,10] = [1/3628800,11/7257600,1/207360]
l_am[10:,11] = [1/39916800,1/6652800]
l_am[11:,12] = [1/479001600]

l_bdf = np.zeros((6,7),np.float64)
l_bdf[:,0] = [1,2/3,6/11,24/50,120/274,720/1764]
l_bdf[:,1] = 1.
l_bfd[1:,2] = [1/3,6/11,35/50,225/274,1624/1764]
l_bdf[2:,3] = [1/11, 10/50, 85/274, 735/1764]
l_bdf[3:,4] = [1/50,15/174,175/1764]
l_bdf[4:,5] = [1/274,21/1764]
l_bdf[5:,6] = [1/1764]


